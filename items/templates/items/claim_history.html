{% extends 'base.html' %}
{% block content %}
<div class="min-h-screen bg-[#0f172a] py-12 px-8 text-white">
    <div class="max-w-7xl mx-auto mb-10">
        <h1 class="text-3xl font-bold text-blue-500 mb-2">Claim History</h1>
        <p class="text-slate-400">Track the status of items you have claimed from the Global Feed.</p>
    </div>

    <div class="max-w-7xl mx-auto overflow-hidden rounded-xl border border-blue-500/30 bg-[#1e293b]/20 shadow-2xl">
        <table class="w-full text-left border-collapse">
            <thead class="bg-blue-600 text-white text-xs uppercase font-black tracking-widest">
                <tr>
                    <th class="px-6 py-5">Item Name</th>
                    <th class="px-6 py-5">Finder</th>
                    <th class="px-6 py-5">Claim Date</th>
                    <th class="px-6 py-5">Proof Provided</th>
                    <th class="px-6 py-5">Status</th>
                    <th class="px-6 py-5">Action</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-slate-800">
                {% for claim in claims %}
                <tr class="hover:bg-[#2d3a4f]/30 transition">
                    <td class="px-6 py-5 font-bold">{{ claim.item.title }}</td>
                    <td class="px-6 py-5 text-slate-400 text-sm">{{ claim.item.user.username }}</td>
                    <td class="px-6 py-5 text-slate-400 text-sm">{{ claim.created_at|date:"M d, Y" }}</td>
                    <td class="px-6 py-5 text-slate-400 text-sm italic">{{ claim.proof_description|truncatechars:30 }}</td>
                    <td class="px-6 py-5">
                        <span class="px-3 py-1 rounded text-[10px] font-black uppercase
                            {% if claim.status == 'PENDING' %} bg-amber-500/20 text-amber-400 border border-amber-500/50 
                            {% elif claim.status == 'APPROVED' %} bg-green-500/20 text-green-400 border border-green-500/50
                            {% else %} bg-red-500/20 text-red-400 border border-red-500/50 {% endif %}">
                            {{ claim.status }}
                        </span>
                    </td>
                    <td class="px-6 py-5 flex items-center gap-6">
                        <a href="{% url 'messages_view' receiver_id=item.user.id %}" class="btn-primary">
    Contact Finder
</a>
                        <form action="{% url 'delete_claim' claim.id %}" method="POST" onsubmit="return confirm('Are you sure you want to remove this claim from your history?');">
                            {% csrf_token %}
                            <button type="submit" class="text-red-500 hover:text-red-400 transition-colors">
                                <i class="fa-solid fa-trash-can" title="Delete Claim"></i>
                            </button>
                        </form>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" class="px-6 py-24 text-center">
                        <div class="flex flex-col items-center">
                            <i class="fa-solid fa-clock-rotate-left text-4xl mb-4 text-slate-700"></i>
                            <p class="text-slate-500 font-medium">You haven't made any claims yet.</p>
                            <a href="{% url 'item_list' %}" class="mt-4 text-blue-500 hover:underline font-bold">Browse the Global Feed</a>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}